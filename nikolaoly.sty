% Boost Software License - Version 1.0 - August 17th, 2003
%
% Copyright (c) 2021 Dylan Yu [dylanyu66 at gmail.com]
% https://yu-dylan.github.io/ || https://github.com/Yu-Dylan/
%
% Modifications and enhancements:
% Copyright (c) 2025-2026 Nikola Veselinov [nikola.veselinov.veselinov@gmail.com]
% https://nikolaveselinov.github.io/ || https://github.io/nikolaveselinov/
%
% Permission is hereby granted, free of charge, to any person or organization
% obtaining a copy of the software and accompanying documentation covered by
% this license (the "Software") to use, reproduce, display, distribute,
% execute, and transmit the Software, and to prepare derivative works of the
% Software, and to permit third-parties to whom the Software is furnished to
% do so, all subject to the following:
%
% The copyright notices in the Software and this entire statement, including
% the above license grant, this restriction and the following disclaimer,
% must be included in all copies of the Software, in whole or in part, and
% all derivative works of the Software, unless such copies or derivative
% works are solely in the form of machine-executable object code generated by
% a source language processor.
%
% THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
% FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
% SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
% FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
% ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
% DEALINGS IN THE SOFTWARE.
\ProvidesPackage{nikolaoly}

% Option flags (defined early so they can be used in conditionals below)
\newif\ifnikolaolyfancy\nikolaolyfancytrue
\newif\ifnikolaolyhdr\nikolaolyhdrtrue
\newif\ifnikolaolyhref\nikolaolyhreftrue
\newif\ifnikolaolysetup\nikolaolysetuptrue
\newif\ifnikolaolythm\nikolaolythmtrue
\newif\ifnikolaolysecthm\nikolaolysecthmfalse
\newif\ifnikolaolyht\nikolaolyhtfalse
\newif\ifnikolaolypkg\nikolaolypkgtrue
\newif\ifnikolaolypdf\nikolaolypdftrue
\newif\ifnikolaolyauthor\nikolaolyauthortrue
\newif\ifnikolaolymdthm\nikolaolymdthmfalse
\newif\ifnikolaolydiagrams\nikolaolydiagramsfalse
\newif\ifnikolaolypatchasy\nikolaolypatchasyfalse
\newif\ifnikolaolyhints\nikolaolyhintsfalse
\newif\ifnikolaolyasy\nikolaolyasytrue
\newif\ifnikolaolycolorsec\nikolaolycolorsecfalse
\newif\ifnikolaolytitlemark\nikolaolytitlemarktrue
\newif\ifnikolaolynopts\nikolaolynoptsfalse
\newif\ifnikolaolyretro\nikolaolyretrofalse
\newif\ifnikolaolycabin\nikolaolycabinfalse
\newif\ifnikolaolydarkmode\nikolaolydarkmodefalse
\newif\ifnikolaolybulgarian\nikolaolybulgarianfalse
\newif\ifnikolaolyskak\nikolaolyskakfalse
\newif\ifnikolaolytitledecorations\nikolaolytitledecorationsfalse
\newif\ifnikolaolysectionleaves\nikolaolysectionleavesfalse
\usepackage{amsmath,amssymb,amsthm}
\usepackage[dvipsnames]{xcolor}
\usepackage{graphicx, pifont}
\usepackage[usestackEOL]{stackengine}
\usepackage{scalerel}

\usepackage{shapepar}
\usepackage{changepage}
\usepackage{microtype}
\usepackage{lipsum}
\usepackage{tikz}
\usepackage{natbib}
\usepackage{graphicx}
\usepackage{fontawesome}
\usepackage{paralist}
\IfFileExists{skak.sty}{%
  \nikolaolyskaktrue
  \RequirePackage[skaknew]{skak}%
}{%
  \nikolaolyskakfalse
  \PackageWarning{nikolaoly}{skak.sty not found; falling back to text chess icons}%
  \providecommand{\BlackPawnOnWhite}{\text{\bfseries P}}%
  \providecommand{\BlackRookOnWhite}{\text{\bfseries R}}%
  \providecommand{\BlackKnightOnWhite}{\text{\bfseries N}}%
  \providecommand{\BlackBishopOnWhite}{\text{\bfseries B}}%
  \providecommand{\BlackQueenOnWhite}{\text{\bfseries Q}}%
  \providecommand{\BlackKingOnWhite}{\text{\bfseries K}}%
}%
\RequirePackage{etoolbox}

\DeclareRobustCommand{\alegreyafont}{\fontfamily{Alegreya-LF}\selectfont} % defines alegreya
\DeclareRobustCommand{\notofont}{\fontfamily{NotoSans-TLF}\selectfont}
% Use Computer Modern Super for merri when Bulgarian is active (has T2A support)
\ifnikolaolybulgarian
  \DeclareRobustCommand{\merri}{\fontfamily{cmss}\selectfont}
\else
  \DeclareRobustCommand{\merri}{\fontfamily{MerriwthrSans-OsF}\selectfont} % TeX 2021 update
\fi

% Early fallbacks so \nikolatitle is always defined even if later TikZ decoration is unavailable
\providecommand{\titlepagedecoration}{}
\providecommand{\nikolatitle}{\maketitle\titlepagedecoration\thispagestyle{empty}}

% Language-aware labels for theorem-like environments
\newcommand{\nikolaNameTheorem}{\ifnikolaolybulgarian Теорема\else Theorem\fi}
\newcommand{\nikolaNameLemma}{\ifnikolaolybulgarian Лема\else Lemma\fi}
\newcommand{\nikolaNameCorollary}{\ifnikolaolybulgarian Следствие\else Corollary\fi}
\newcommand{\nikolaNamePostulate}{\ifnikolaolybulgarian Постулат\else Postulate\fi}
\newcommand{\nikolaNameProposition}{\ifnikolaolybulgarian Твърдение\else Proposition\fi}
\newcommand{\nikolaNameLaw}{\ifnikolaolybulgarian Закон\else Law\fi}
\newcommand{\nikolaNameDefinition}{\ifnikolaolybulgarian Дефиниция\else Definition\fi}
\newcommand{\nikolaNameExample}{\ifnikolaolybulgarian Пример\else Example\fi}
\newcommand{\nikolaNameMoral}{\ifnikolaolybulgarian Поука\else Moral\fi}
\newcommand{\nikolaNameProblem}{\ifnikolaolybulgarian Задача\else Problem\fi}
\newcommand{\nikolaNameProblems}{\ifnikolaolybulgarian Задачи\else Problems\fi}
\newcommand{\nikolaNameFact}{\ifnikolaolybulgarian Факт\else Fact\fi}
\newcommand{\nikolaNameExercise}{\ifnikolaolybulgarian Упражнение\else Exercise\fi}
\newcommand{\nikolaNameBaseCase}{\ifnikolaolybulgarian База\else Base Case\fi}
\newcommand{\nikolaNameIndStep}{\ifnikolaolybulgarian Индуктивна стъпка\else Inductive Step\fi}
\newcommand{\nikolaNameCase}{\ifnikolaolybulgarian Случай\else Case\fi}
\newcommand{\nikolaNameRemark}{\ifnikolaolybulgarian Забележка\else Remark\fi}
\newcommand{\nikolaNameWalk}{\ifnikolaolybulgarian Разбор\else Walkthrough\fi}
\newcommand{\nikolaNameNotation}{\ifnikolaolybulgarian Означение\else Notation\fi}
\newcommand{\nikolaNameClaim}{\ifnikolaolybulgarian Твърдение\else Claim\fi}

% Bulgarian helper: wrap text in optional Bulgarian language if enabled
\providecommand{\bg}[1]{% optional helper for Bulgarian text
  \ifnikolaolybulgarian
    \foreignlanguage{bulgarian}{#1}%
  \else
    #1%
  \fi
}


%%fakesection Argument processing
% Default Arguments
% We include "nikolaoly" in all of these to make sure
% that they don't collide with anything in external packages
\let\oldding\ding% Store old \ding in \oldding
\renewcommand{\ding}[2][1]{\scalebox{#1}{\oldding{#2}}}

\definecolor{Ylow}{RGB}{248,230,4}

\newcommand\dangersign[1][2ex]{%
  \renewcommand\stacktype{L}%
  \scaleto{\stackon[1.5pt]{\color{red}$\triangle$}{\tiny\bfseries \color{black}{!}}}{#1}%
}

\def\maincolor{BlueViolet} % one color only, no halves and stuff
\newcommand{\changemaincolor}[1]{
    \def\maincolor{#1}
}
\newcommand{\changemaincolorhtml}[1]{
    \definecolor{tempcolor}{HTML}{#1}
    \changemaincolor{tempcolor}
    \changesecondcolor{tempcolor}
}

\def\secondcolor{BlueViolet} % one color only, no halves and stuff
\newcommand{\changesecondcolor}[1]{
    \def\secondcolor{#1}
}
\newcommand{\changesecondcolorhtml}[1]{
    \definecolor{tempcolor2}{HTML}{#1}
    \changesecondcolor{tempcolor2}
}

\newif\ifnikolaolyfancy\nikolaolyfancytrue
\newif\ifnikolaolyhdr\nikolaolyhdrtrue
\newif\ifnikolaolyhref\nikolaolyhreftrue
\newif\ifnikolaolysetup\nikolaolysetuptrue
\newif\ifnikolaolythm\nikolaolythmtrue
\newif\ifnikolaolysecthm\nikolaolysecthmfalse
\newif\ifnikolaolyht\nikolaolyhtfalse
\newif\ifnikolaolypkg\nikolaolypkgtrue
\newif\ifnikolaolypdf\nikolaolypdftrue
\newif\ifnikolaolyauthor\nikolaolyauthortrue
\newif\ifnikolaolymdthm\nikolaolymdthmfalse
\newif\ifnikolaolydiagrams\nikolaolydiagramsfalse
\newif\ifnikolaolypatchasy\nikolaolypatchasyfalse
\newif\ifnikolaolyhints\nikolaolyhintsfalse
%Receive Arguments
% allow href to override this one

\DeclareOption{sleek}{\nikolaolysecthmtrue\nikolaolymdthmtrue\nikolaolycolorsectrue} % long docs
\DeclareOption{nopts}{\nikolaolynoptstrue}
\DeclareOption{retro}{\nikolaolyretrotrue}

\DeclareOption{fancy}{\nikolaolyfancytrue}
\DeclareOption{nofancy}{\nikolaolyfancyfalse}
\DeclareOption{hdr}{\nikolaolyhdrtrue}
\DeclareOption{nohdr}{\nikolaolyhdrfalse}
\DeclareOption{href}{\nikolaolyhreftrue}
\DeclareOption{nohref}{\nikolaolyhreffalse}

\DeclareOption{nosetup}{\nikolaolysetupfalse}
\DeclareOption{thm}{\nikolaolythmtrue}
\DeclareOption{nothm}{\nikolaolythmfalse}
\DeclareOption{secthm}{\nikolaolysecthmtrue}
\DeclareOption{nosecthm}{\nikolaolysecthmfalse}

\DeclareOption{ht}{\nikolaolyhttrue}
\DeclareOption{nopdf}{\nikolaolypdffalse}
\DeclareOption{nopkg}{\nikolaolypkgfalse}
\DeclareOption{noauthor}{\nikolaolyauthorfalse}
\DeclareOption{titlemark}{\nikolaolytitlemarktrue} % Sets title in ohead, not \rightmark
\DeclareOption{sectionmark}{\nikolaolytitlemarkfalse} % Uses \rightmark not title in ohead

\DeclareOption{mdthm}{\nikolaolymdthmtrue}
\DeclareOption{nomdthm}{\nikolaolymdthmfalse}
\DeclareOption{diagrams}{\nikolaolydiagramstrue}
\DeclareOption{nodiagrams}{\nikolaolydiagramsfalse}
\DeclareOption{colorsec}{\nikolaolycolorsectrue}
\DeclareOption{nocolorsec}{\nikolaolycolorsecfalse}

\DeclareOption{patchasy}{\nikolaolypatchasytrue}
\DeclareOption{noasy}{\nikolaolyasyfalse}

\DeclareOption{hints}{\nikolaolyhintstrue}

\DeclareOption{cabin}{\nikolaolycabintrue}

\DeclareOption{darkmode}{\nikolaolydarkmodetrue}
\DeclareOption{bulgarian}{\nikolaolybulgariantrue}
\DeclareOption{titledecorations}{\nikolaolytitledecorationstrue}
\DeclareOption{notitledecorations}{\nikolaolytitledecorationsfalse}
\DeclareOption{sectionleaves}{\nikolaolysectionleavestrue}
\DeclareOption{nosectionleaves}{\nikolaolysectionleavesfalse}

\ProcessOptions\relax

% Fonts and language setup (after options are known)
\ifnikolaolybulgarian
  \IfFileExists{t2aenc.def}{%
    \usepackage[T2A,T1]{fontenc}%
    \usepackage[utf8]{inputenc}%  % Specify input encoding for Bulgarian
  }{%
    \PackageWarning{nikolaoly}{T2A encoding not found; disabling bulgarian option}%
    \nikolaolybulgarianfalse
    \usepackage[T1]{fontenc}%
    % Minimal transliteration so Cyrillic text does not halt compilation
    \DeclareUnicodeCharacter{0410}{A}% А
    \DeclareUnicodeCharacter{0411}{B}% Б
    \DeclareUnicodeCharacter{0412}{V}% В
    \DeclareUnicodeCharacter{0413}{G}% Г
    \DeclareUnicodeCharacter{0414}{D}% Д
    \DeclareUnicodeCharacter{0415}{E}% Е
    \DeclareUnicodeCharacter{0416}{Zh}% Ж
    \DeclareUnicodeCharacter{0417}{Z}% З
    \DeclareUnicodeCharacter{0418}{I}% И
    \DeclareUnicodeCharacter{0419}{Y}% Й
    \DeclareUnicodeCharacter{041A}{K}% К
    \DeclareUnicodeCharacter{041B}{L}% Л
    \DeclareUnicodeCharacter{041C}{M}% М
    \DeclareUnicodeCharacter{041D}{N}% Н
    \DeclareUnicodeCharacter{041E}{O}% О
    \DeclareUnicodeCharacter{041F}{P}% П
    \DeclareUnicodeCharacter{0420}{R}% Р
    \DeclareUnicodeCharacter{0421}{S}% С
    \DeclareUnicodeCharacter{0422}{T}% Т
    \DeclareUnicodeCharacter{0423}{U}% У
    \DeclareUnicodeCharacter{0424}{F}% Ф
    \DeclareUnicodeCharacter{0425}{H}% Х
    \DeclareUnicodeCharacter{0426}{Ts}% Ц
    \DeclareUnicodeCharacter{0427}{Ch}% Ч
    \DeclareUnicodeCharacter{0428}{Sh}% Ш
    \DeclareUnicodeCharacter{0429}{Sht}% Щ
    \DeclareUnicodeCharacter{042A}{A}% Ъ
    \DeclareUnicodeCharacter{042B}{Y}% Ы
    \DeclareUnicodeCharacter{042C}{'}% Ь
    \DeclareUnicodeCharacter{042D}{E}% Э
    \DeclareUnicodeCharacter{042E}{Yu}% Ю
    \DeclareUnicodeCharacter{042F}{Ya}% Я
    \DeclareUnicodeCharacter{0430}{a}% а
    \DeclareUnicodeCharacter{0431}{b}% б
    \DeclareUnicodeCharacter{0432}{v}% в
    \DeclareUnicodeCharacter{0433}{g}% г
    \DeclareUnicodeCharacter{0434}{d}% д
    \DeclareUnicodeCharacter{0435}{e}% е
    \DeclareUnicodeCharacter{0436}{zh}% ж
    \DeclareUnicodeCharacter{0437}{z}% з
    \DeclareUnicodeCharacter{0438}{i}% и
    \DeclareUnicodeCharacter{0439}{y}% й
    \DeclareUnicodeCharacter{043A}{k}% к
    \DeclareUnicodeCharacter{043B}{l}% л
    \DeclareUnicodeCharacter{043C}{m}% м
    \DeclareUnicodeCharacter{043D}{n}% н
    \DeclareUnicodeCharacter{043E}{o}% о
    \DeclareUnicodeCharacter{043F}{p}% п
    \DeclareUnicodeCharacter{0440}{r}% р
    \DeclareUnicodeCharacter{0441}{s}% с
    \DeclareUnicodeCharacter{0442}{t}% т
    \DeclareUnicodeCharacter{0443}{u}% у
    \DeclareUnicodeCharacter{0444}{f}% ф
    \DeclareUnicodeCharacter{0445}{h}% х
    \DeclareUnicodeCharacter{0446}{ts}% ц
    \DeclareUnicodeCharacter{0447}{ch}% ч
    \DeclareUnicodeCharacter{0448}{sh}% ш
    \DeclareUnicodeCharacter{0449}{sht}% щ
    \DeclareUnicodeCharacter{044A}{a}% ъ
    \DeclareUnicodeCharacter{044B}{y}% ы
    \DeclareUnicodeCharacter{044C}{'}% ь
    \DeclareUnicodeCharacter{044D}{e}% э
    \DeclareUnicodeCharacter{044E}{yu}% ю
    \DeclareUnicodeCharacter{044F}{ya}% я
  }%
  \ifnikolaolybulgarian
    \IfFileExists{bulgarian.ldf}{%
      \usepackage[english,bulgarian]{babel}%
    }{%
      \PackageWarning{nikolaoly}{bulgarian.ldf missing; loading english only}%
      \nikolaolybulgarianfalse
      \usepackage[english]{babel}%
    }%
  \else
    \usepackage[english]{babel}%
  \fi
\else
  \usepackage[T1]{fontenc}
  \usepackage[english]{babel}
\fi
\usepackage{lmodern}

% if packages not loaded, turn off mdthm and asy
\ifnikolaolypkg\else\nikolaolymdthmfalse\fi
\ifnikolaolypkg\else\nikolaolyasyfalse\fi

% If no setup, turn off theorems
\ifnikolaolysetup\else\nikolaolythmfalse\fi

% Skip cabin when Bulgarian is active (lacks T2A support)
\ifnikolaolycabin
  \ifnikolaolybulgarian\else
    \usepackage{cabin}
  \fi
\fi

%%fakesection Some macros
%Small commands
\newcommand{\cbrt}[1]{\sqrt[3]{#1}}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\ceiling}[1]{\left\lceil #1 \right\rceil}
\newcommand{\mailto}[1]{\href{mailto:#1}{\texttt{#1}}}
\newcommand{\ol}{\overline}
\newcommand{\ul}{\underline}
\newcommand{\wt}{\widetilde}
\newcommand{\wh}{\widehat}
\newcommand{\eps}{\varepsilon}
\newcommand{\SX}{\mathcal{X}}
\newcommand{\SW}{\mathcal{W}}
%\renewcommand{\iff}{\Leftrightarrow}
%\renewcommand{\implies}{\Rightarrow}
\definecolor{green1}{RGB}{52, 252, 52}
\definecolor{green2}{RGB}{88,222,44}
\definecolor{SkyBlue2}{RGB}{70,130,180}
\definecolor{Ultra}{RGB}{18,10,143}

\ifnikolaolydarkmode
\ifnikolaolyretro
\newcommand{\vocab}[1]{\textsf{\textbf{\textsl{\color{Violet!20!white} #1}}}}
\else
\newcommand{\vocab}[1]{\textsf{\textbf{\textsl{\color{Violet!50} #1}}}}
\fi
\else
\ifnikolaolyretro
\newcommand{\vocab}[1]{\textsf{\textbf{\textsl{\color{retropink} #1}}}}
\else
\newcommand{\vocab}[1]{\textsf{\textbf{\textsl{\color{Violet} #1}}}}
\fi
\fi
\providecommand{\alert}{\vocab}
\providecommand{\half}{\frac{1}{2}}
\newcommand{\catname}{\mathsf}
\newcommand{\hrulebar}{
  \par\hspace{\fill}\rule{0.95\linewidth}{.7pt}\hspace{\fill}
  \par\nointerlineskip \vspace{\baselineskip}
}

%For use in author command
\newcommand{\plusemail}[1]{\\ \normalfont \texttt{\mailto{#1}}}

%More commands and math operators
\DeclareMathOperator{\cis}{cis}
\DeclareMathOperator*{\lcm}{lcm}
\DeclareMathOperator*{\argmin}{arg min}
\DeclareMathOperator*{\argmax}{arg max}

%Convenient Environments
\newenvironment{soln}{\begin{proof}[Solution]}{\end{proof}}
\newenvironment{answer}{\begin{proof}[Answer]}{\end{proof}}
\newenvironment{parlist}{\begin{inparaenum}[(i)]}{\end{inparaenum}}
\newenvironment{gobble}{\setbox\z@\vbox\bgroup}{\egroup}

%Inequalities
\newcommand{\cycsum}{\sum_{\mathrm{cyc}}}
\newcommand{\symsum}{\sum_{\mathrm{sym}}}
\newcommand{\cycprod}{\prod_{\mathrm{cyc}}}
\newcommand{\symprod}{\prod_{\mathrm{sym}}}
\newcommand{\peq}{\preceq}
\newcommand{\seq}{\succeq}
\newcommand{\pe}{\prec}
\newcommand{\se}{\succ}
% The sets of mathbb (use providecommand to avoid clashes with other packages)
\providecommand{\BB}{\mathbb B}
\providecommand{\CC}{\mathbb C}
\providecommand{\DD}{\mathbb D}
\providecommand{\EE}{\mathbb E}
\providecommand{\FF}{\mathbb F}
\providecommand{\GG}{\mathbb G}
\providecommand{\HH}{\mathbb H}
\providecommand{\II}{\mathbb I}
\providecommand{\JJ}{\mathbb J}
\providecommand{\KK}{\mathbb K}
\providecommand{\LL}{\mathbb L}
\providecommand{\MM}{\mathbb M}
\providecommand{\NN}{\mathbb N}
\providecommand{\PP}{\mathbb P}
\providecommand{\QQ}{\mathbb Q}
\providecommand{\RR}{\mathbb R}
\providecommand{\ZZ}{\mathbb Z}
\newcommand{\charin}{\text{ char }}
\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\Syl}{Syl}
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\GL}{GL} % General linear group
\DeclareMathOperator{\SL}{SL} % Special linear group

%From Kiran Kedlaya's "Geometry Unbound"
\newcommand{\abs}[1]{\left\lvert #1 \right\rvert}
\newcommand{\norm}[1]{\left\lVert #1 \right\rVert}
\newcommand{\dang}{\measuredangle} %% Directed angle
\newcommand{\ray}[1]{\overrightarrow{#1}} 
\newcommand{\seg}[1]{\overline{#1}}
\newcommand{\arc}[1]{\wideparen{#1}}

%From M275 "Topology" at SJSU
\newcommand{\id}{\mathrm{id}}
\newcommand{\taking}[1]{\xrightarrow{#1}}
\newcommand{\inv}{^{-1}}

%From M170 "Introduction to Graph Theory" at SJSU
\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\ord}{ord}
\newcommand{\defeq}{\overset{\mathrm{def}}{=}}

%From the USAMO .tex files
\newcommand{\ts}{\textsuperscript}
\newcommand{\dg}{^\circ}
\newcommand{\ii}{\item}

% From Math 55 and Math 145 at Harvard
\newenvironment{subproof}[1][Proof]{%
\begin{proof}[#1] \renewcommand{\qedsymbol}{$\blacksquare$}}%
{\end{proof}}

%\newcommand{\liff}{\leftrightarrow}
%\newcommand{\lthen}{\rightarrow}
%\newcommand{\opname}{\operatorname}
%\newcommand{\surjto}{\twoheadrightarrow}
%\newcommand{\injto}{\hookrightarrow}
%\newcommand{\On}{\mathrm{On}} % ordinals
\DeclareMathOperator{\img}{im} % Image
\DeclareMathOperator{\Img}{Im} % Image
\DeclareMathOperator{\coker}{coker} % Cokernel
\DeclareMathOperator{\Coker}{Coker} % Cokernel
\DeclareMathOperator{\Ker}{Ker} % Kernel
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\Spec}{Spec} % spectrum
\DeclareMathOperator{\Tr}{Tr} % trace
\DeclareMathOperator{\pr}{pr} % projection
\DeclareMathOperator{\ext}{ext} % extension
\DeclareMathOperator{\pred}{pred} % predecessor
\DeclareMathOperator{\dom}{dom} % domain
\DeclareMathOperator{\ran}{ran} % range
\DeclareMathOperator{\Hom}{Hom} % homomorphism
\DeclareMathOperator{\Mor}{Mor} % morphisms
\DeclareMathOperator{\End}{End} % endomorphism


\definecolor{RusPurple}{RGB}{029, 002, 053}
% Things Lie
% \newcommand{\kb}{\mathfrak b}
% \newcommand{\kg}{\mathfrak g}
% \newcommand{\kh}{\mathfrak h}
% \newcommand{\kn}{\mathfrak n}
% \newcommand{\ku}{\mathfrak u}
% \newcommand{\kz}{\mathfrak z}
% \DeclareMathOperator{\Ext}{Ext} % Ext functor
% \DeclareMathOperator{\Tor}{Tor} % Tor functor
% \newcommand{\gl}{\opname{\mathfrak{gl}}} % frak gl group
% \renewcommand{\sl}{\opname{\mathfrak{sl}}} % frak sl group chktex 6

% A few mathcal
 \newcommand{\SA}{\mathcal A}
 \newcommand{\SB}{\mathcal B}
 \newcommand{\SC}{\mathcal C}
 \newcommand{\SD}{\mathcal D}
 \newcommand{\SF}{\mathcal F}
 \newcommand{\SG}{\mathcal G}
 \newcommand{\SH}{\mathcal H}
 \newcommand{\OO}{\mathcal O}
 \newcommand{\SM}{\mathcal{M}}
% \newcommand{\SCA}{\mathscr A}
% \newcommand{\SCB}{\mathscr B}
% \newcommand{\SCC}{\mathscr C}
% \newcommand{\SCD}{\mathscr D}
% \newcommand{\SCE}{\mathscr E}
% \newcommand{\SCF}{\mathscr F}
% \newcommand{\SCG}{\mathscr G}
% \newcommand{\SCH}{\mathscr H}

% Mathfrak primes
% \newcommand{\km}{\mathfrak m}
% \newcommand{\kp}{\mathfrak p}
% \newcommand{\kq}{\mathfrak q}

%% Napkin commands
% \newcommand{\prototype}[1]{
%	\emph{{\color{red} Prototypical example for this section:} #1} \par\medskip
% }

\newcommand{\paren}[1]{\left( #1 \right)}
\newcommand{\vangle}[1]{\left\langle #1 \right\rangle}

\usepackage{thmtools}

\RequirePackage{xcolor}

\definecolor{darkmidnightblue}{rgb}{0.0, 0.2, 0.4}
\definecolor{sangria}{rgb}{0.57, 0.0, 0.04}

% \colorlet{LightRubineRed}{RubineRed!70!}
\definecolor{oucrimsonred}{rgb}{0.6, 0.0, 0.0} % syllabus section
\definecolor{darkred}{rgb}{0.9, 0.00, 0.0}

\definecolor{dennispurple}{RGB}{45,0,90} % dark purple
\definecolor{lightpurple}{RGB}{230,230,250}

\definecolor{thmblue}{rgb}{0.88, 0.95, 0.98}
\definecolor{darkblue}{RGB}{36,57,108}

\definecolor{thmgreen}{RGB}{207,241,208}
\definecolor{darkgreen}{RGB}{30,70,30}

\definecolor{thmred}{RGB}{240, 200, 200}
\definecolor{labelred}{RGB}{120, 30, 20}
\definecolor{importantred}{RGB}{100,15,15}

\definecolor{thmyellow}{HTML}{faf5cd}
\definecolor{labelyellow}{HTML}{999400}

\definecolor{proofbrown}{RGB}{100,40,40}
\definecolor{titlered}{rgb}{1.0, 0.0, 0.0}

\definecolor{persianblue}{rgb}{0.11, 0.22, 0.73}

% theorem colors

\definecolor{thmblue}{rgb}{0.88, 0.95, 0.98}
\definecolor{darkblue}{RGB}{36,57,108}
\definecolor{wildblueyonder}{rgb}{0.64, 0.68, 0.82}

\definecolor{thmgreen}{RGB}{207,241,208}
\definecolor{darkgreen}{RGB}{30,70,30}

\definecolor{thmred}{RGB}{240, 200, 200}
\definecolor{darkred}{RGB}{120, 30, 20}

\definecolor{proofbrown}{RGB}{100,40,40}
\definecolor{aqua}{rgb}{0,1,1}

\definecolor{retropink}{HTML}{F56866}
\definecolor{retroblue}{rgb}{0.45, 0.66, 0.76}
\definecolor{retrogreen}{HTML}{336C5E}
\definecolor{retrocyan}{rgb}{0.0, 0.55, 0.55}
\definecolor{retropurple}{rgb}{0.6, 0.2, 0.8}
\definecolor{retroorange}{HTML}{FD6A02}
\definecolor{retroindigo}{HTML}{5E67B8}
\definecolor{retroiris}{rgb}{0.35, 0.31, 0.81}
\definecolor{retrolazuli}{rgb}{0.15, 0.38, 0.61}
\definecolor{retrolavender}{rgb}{0.8, 0.8, 1.0}
\definecolor{retrograss}{HTML}{5DBB63}

\ifnikolaolydarkmode
\ifnikolaolyretro
\newtheoremstyle{nikolatheo}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retroblue!50!white}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolatheononum}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retroblue!50!white}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikoladef}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retropink!40!white}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\footnotesize{\thmnote{#3}}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaexam}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{SpringGreen!40!white}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolamoral}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retrocyan!30}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaprob}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retropurple!10!white}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolafact}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retroorange!35}\sffamily\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')

\newtheoremstyle{nikolaexercise}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\small\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retroindigo!30}\sffamily\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%
  
\newtheoremstyle{nikolaProblem}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\notofont\color{\maincolor}\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%
  
\newtheoremstyle{nikolaProblemnonum}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\notofont\color{\maincolor}\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%
  
\newtheoremstyle{nikolawalk}%                % Name
  {}%                                     % Space above
  {}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retrograss}\sffamily\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  {1.5mm}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ #3}}%
  
\newtheoremstyle{nikolainduct}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{SkyBlue!55}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolacase}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{Magenta!15}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaremark}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\small\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{white}\sffamily\itshape}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')

  \newtheoremstyle{nikolaremarknonum}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\small\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{white}\sffamily\itshape}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolamini}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{black}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaclaim}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{Emerald!5}\sffamily\bfseries}%                            % Theorem head font
  { --- }%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1} \thmnote{ (#3)}}%   
\else
\newtheoremstyle{nikolatheo}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{wildblueyonder!90!black}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolatheononum}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{wildblueyonder!90!black}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikoladef}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{WildStrawberry!50!white}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\footnotesize{\thmnote{#3}}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaexam}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{thmgreen!90!black}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolamoral}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{aqua!10}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaprob}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{BlueViolet!10!white}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolafact}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{Dandelion!50}\sffamily\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')

\newtheoremstyle{nikolaexercise}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\small\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{MidnightBlue!50}\sffamily\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%
  
\newtheoremstyle{nikolaProblem}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\notofont\color{\maincolor}\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%
  
\newtheoremstyle{nikolaProblemnonum}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\notofont\color{\maincolor}\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%
  
\newtheoremstyle{nikolawalk}%                % Name
  {}%                                     % Space above
  {}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{PineGreen}\sffamily\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  {1.5mm}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ #3}}%
  
\newtheoremstyle{nikolainduct}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{SkyBlue!35}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolacase}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{Magenta!45}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaremark}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\small\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{white}\sffamily\itshape}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaremark}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\small\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{white}\sffamily\itshape}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolamini}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\color{white}}%                                     % Body font
  {}%                                     % Indent amount
  {\color{white}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline\color{white}}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaclaim}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{NavyBlue!5}\sffamily\bfseries}%                            % Theorem head font
  { --- }%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1} \thmnote{ (#3)}}%   % dm indic
\fi
\else
\ifnikolaolyretro
\newtheoremstyle{nikolatheo}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retroblue}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolatheononum}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retroblue}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikoladef}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retropink}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\footnotesize{\thmnote{#3}}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaexam}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retrogreen}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolamoral}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retrocyan}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaprob}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retropurple}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolafact}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retroorange}\sffamily\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')

\newtheoremstyle{nikolaexercise}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\small}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retroindigo}\sffamily\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%
  
\newtheoremstyle{nikolaProblem}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\notofont\color{\maincolor}\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%
  
\newtheoremstyle{nikolaProblemnonum}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\notofont\color{\maincolor}\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%
  
\newtheoremstyle{nikolawalk}%                % Name
  {}%                                     % Space above
  {}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{retrograss}\sffamily\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  {1.5mm}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ #3}}%
  
\newtheoremstyle{nikolainduct}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{Cyan!50!retrolazuli}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolacase}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{Magenta!50!retrolazuli}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaremark}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\small}%                                     % Body font
  {}%                                     % Indent amount
  {\color{black}\sffamily\itshape}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaremarknonum}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\small}%                                     % Body font
  {}%                                     % Indent amount
  {\color{black}\sffamily\itshape}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolamini}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{black}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaclaim}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{Cyan!40!black}\sffamily\bfseries}%                            % Theorem head font
  { --- }%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1} \thmnote{ (#3)}}%   
\else
\newtheoremstyle{nikolatheo}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{darkblue}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolatheononum}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{darkblue}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikoladef}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{sangria}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\footnotesize{\thmnote{#3}}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaexam}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{ForestGreen}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolamoral}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{aqua!95!black}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaprob}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{RoyalPurple}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolafact}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{BurntOrange}\sffamily\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')

\newtheoremstyle{nikolaexercise}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\small}%                                     % Body font
  {}%                                     % Indent amount
  {\color{NavyBlue}\sffamily\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%
  
\newtheoremstyle{nikolaProblem}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\notofont\color{\maincolor}\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%
  
\newtheoremstyle{nikolaProblemnonum}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\notofont\color{\maincolor}\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%
  
\newtheoremstyle{nikolawalk}%                % Name
  {}%                                     % Space above
  {}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{PineGreen}\sffamily\bfseries}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  {1.5mm}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ #3}}%
  
\newtheoremstyle{nikolainduct}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{Cyan!50!CornflowerBlue}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolacase}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{Magenta!50!CornflowerBlue}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaremark}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\small}%                                     % Body font
  {}%                                     % Indent amount
  {\color{black}\sffamily\itshape}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaremarknonum}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {\small}%                                     % Body font
  {}%                                     % Indent amount
  {\color{black}\sffamily\itshape}%                            % Theorem head font
  {.}%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')

\newtheoremstyle{nikolamini}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{black}\sffamily\bfseries}%                            % Theorem head font
  {}%                                    % Punctuation after theorem head
  {\newline}%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1}\thmnote{ (#3)}}%                                     % Theorem head spec (can be left empty, meaning `normal')
  
\newtheoremstyle{nikolaclaim}%                % Name
  {0pt}%                                     % Space above
  {2pt}%                                     % Space below
  {}%                                     % Body font
  {}%                                     % Indent amount
  {\color{NavyBlue!90!black}\sffamily\bfseries}%                            % Theorem head font
  { --- }%                                    % Punctuation after theorem head
  { }%                                    % Space after theorem head, ' ', or \newline
  {\thmname{#1} \thmnote{ (#3)}}%   
\fi
\fi

\usepackage[framemethod=tikz]{mdframed}

\RequirePackage{tcolorbox}
\tcbuselibrary{skins}
\tcbuselibrary{breakable}
\tcbuselibrary{theorems}

\ifnikolaolydarkmode
\ifnikolaolyretro
\ifnikolaolysecthm
\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retroblue!50!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{theorem}{\nikolaNameTheorem}[section]
\else
\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retroblue!50!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{theorem}{\nikolaNameTheorem}
\fi

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retroblue!50!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{lemma}[theorem]{\nikolaNameLemma}

\theoremstyle{nikolatheononum}
\newmdtheoremenv[% settings
backgroundcolor=retroblue!50!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{lemma*}{\nikolaNameLemma}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retroblue!50!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{corollary}[theorem]{\nikolaNameCorollary}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retroblue!50!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{postulate}[theorem]{\nikolaNamePostulate}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retroblue!50!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{prop}[theorem]{\nikolaNameProposition}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retroblue!50!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{law}[theorem]{\nikolaNameLaw}

\theoremstyle{nikoladef}
\newmdtheoremenv[% settings
backgroundcolor=retropink!60!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retropink!40!white,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{defn}{\nikolaNameDefinition}

\theoremstyle{nikolaexam}
\newmdtheoremenv[% settings
backgroundcolor=retrogreen!60!black,
linecolor=SpringGreen!40!white,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{example}[theorem]{\nikolaNameExample}

\theoremstyle{nikolamoral} 
\newmdtheoremenv[% settings
backgroundcolor=retrocyan,
linecolor=retrocyan!30,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{moral}{\nikolaNameMoral}

\theoremstyle{nikolaprob} 
\newmdtheoremenv[% settings
backgroundcolor=retropurple,
linecolor=retropurple!10!white,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{problem}[theorem]{\nikolaNameProblem}

\theoremstyle{nikolafact}
\newmdtheoremenv[% settings
backgroundcolor=retroorange!80!black,
linecolor=retroorange!35,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{fact}[theorem]{\nikolaNameFact}

\theoremstyle{nikolaexercise}
\newmdtheoremenv[% settings
nobreak=false,
innerleftmargin=0pt,
innerrightmargin=0pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{exercise}[theorem]{\nikolaNameExercise}

\theoremstyle{nikolaProblem}
\newmdtheoremenv[% settings
backgroundcolor=black,
nobreak=false,
innerleftmargin=0pt,
innerrightmargin=0pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{Problem}{\nikolaNameProblem}

\theoremstyle{nikolaProblemnonum}
\newmdtheoremenv[% settings
backgroundcolor=black,
nobreak=false,
innerleftmargin=0pt,
innerrightmargin=0pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{Problem*}{\nikolaNameProblem}

% \makeatletter
% \newcommand\asycode[2][]{%
%   \stepcounter{asy}%
%   \setkeys{ASYkeys}{#1}%
%   \ifASYattach
%     \ASYinlinefalse
%   \fi
%   \ifx\asydir\empty\else
%     \def\ASYprefix{\asydir/}%
%   \fi
%   \immediate\write\AsyPreStream{%
%     \noexpand\InputIfFileExists{%
%       \ASYprefix\noexpand\jobname-\the\c@asy.pre}{}{}%
%   }
%   \asy@write@graphic@header
%   \immediate\write\AsyStream{\detokenize{#2}}% here asy does the writing
%   \asy@finalise@stream
%   \asy@input@graphic
% }
% \makeatother

% \usepackage{environ}
% \NewEnviron{Problem}[1][]{
% \ifx&#1&%
%     \problem{\BODY}
% \else
%     \problem[#1]{\BODY}
% \fi
% }

\theoremstyle{nikolainduct}
\newmdtheoremenv[% settings
backgroundcolor=Cyan!50!retrolazuli,
linecolor=SkyBlue!55,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{basecase}{\nikolaNameBaseCase}

\theoremstyle{nikolainduct}
\newmdtheoremenv[% settings
backgroundcolor=SkyBlue!15,
linecolor=Cyan!50!retrolazuli,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{indstep}{\nikolaNameIndStep}

\theoremstyle{nikolacase}
\newmdtheoremenv[% settings
backgroundcolor=Magenta!50!retrolazuli,
linecolor=Magenta!15,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{case}{\nikolaNameCase}

\theoremstyle{nikolaremark}
\newmdtheoremenv[% settings
backgroundcolor=black!70,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=white,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{remark}[theorem]{\nikolaNameRemark}

\theoremstyle{nikolaremarknonum}
\newmdtheoremenv[% settings
backgroundcolor=black!70,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=white,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{remark*}[theorem]{\nikolaNameRemark}

% \theoremstyle{nikolaremark}
% \newmdtheoremenv[% settings
% backgroundcolor=black!70,
% nobreak=true,
% innertopmargin=5pt,
% innerleftmargin=7pt,
% innerrightmargin=7pt,
% linecolor=white,
% linewidth=3pt,
% topline=false,
% bottomline=false,
% rightline=false,
% leftline=true]{solution}[theorem]{Solution}

\newenvironment{exercisebox}{\begin{mdframed}[backgroundcolor=retroindigo!70!black,linecolor=retroindigo!30,linewidth=1mm,topline=false,bottomline=false,leftline=true,rightline=false,
    innertopmargin=3pt,
    innerbottommargin=2pt,
    innerrightmargin=5pt,
    innerleftmargin=5pt]}{\end{mdframed}}
    
% \newenvironment{problembox}{\begin{mdframed}[backgroundcolor=WildStrawberry!10,linecolor=RedViolet,linewidth=0.3mm,topline=true,bottomline=true,leftline=true,rightline=true,
%     innertopmargin=3pt,
%     innerbottommargin=2pt,
%     innerrightmargin=5pt,
%     innerleftmargin=5pt]}{\end{mdframed}}

\newenvironment{problembox}{}{}
    
\theoremstyle{nikolawalk}

%%added walk for walkthroughs 
\newtheorem*{walk}{\nikolaNameWalk} % always use the enumerate environment during walkthroughs

% \def\walk{\noindent {\color{PineGreen}\sffamily\bfseries Walkthrough. }\hspace*{2mm}}

\usetikzlibrary{calc}
\usepackage{fourier-orns}
\definecolor{warningColor}{HTML}{CC7575}
\tikzset{
  warningsymbol/.style={
      circle,
      draw=black,
      fill=black,
      scale=1,
      overlay}
}

\mdfdefinestyle{warning}{%
 hidealllines=true,leftline=true,
 skipabove=12,skipbelow=12pt,
 backgroundcolor=black,
 innertopmargin=0.2em,%
 innerbottommargin=0.2em,%
 innerrightmargin=0.2em,%
 rightmargin=0.1em,%
 innerleftmargin=1.7em,%
 leftmargin=0.1em,%
 middlelinewidth=.2em,%
 linecolor=warningColor,%
 fontcolor=warningColor,%
 firstextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
 secondextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
 middleextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
 singleextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
}

\makeatletter
\@ifundefined{caution}{\newmdenv[style=warning]{caution}}{\renewmdenv[style=warning]{caution}}
\makeatother

\newcounter{question}
\newenvironment{question}{
\refstepcounter{question}\label{q\thequestion}%
\noindent%
\begin{addmargin}[0em]{0em}
  \makebox[0pt][r]{\tikz[baseline=(text.base)]{
    \coordinate (box top left) at (0, 0);
    \coordinate (box bottom right) at (3em, 1.2\baselineskip);
    \path[use as bounding box] (box top left) rectangle (box bottom right);
    \fill[opacity=0.8, Sepia] (box top left) rectangle (box bottom right) node[midway, anchor=center](textpoint){};
    \node[anchor=center, text=Sepia!10](text) at (textpoint) {\sffamily\arabic{question}};
    \path[draw=Sepia!10, thick] let \p1 = (box top left), \p2 = (box bottom right) in (\p1) -- (\x2, \y1);
  }\hspace{1em}}%
}{
\end{addmargin}
\filbreak
}

\theoremstyle{nikolaclaim}
\newmdtheoremenv[% settings
backgroundcolor=Cyan!40!black,
linecolor=Emerald!5,
linewidth=1mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{claim}{\nikolaNameClaim}
\else
\ifnikolaolysecthm
\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=darkblue!60!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=wildblueyonder!90!black,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{theorem}{\nikolaNameTheorem}[section]
\else
\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=darkblue!60!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=wildblueyonder!90!black,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{theorem}{\nikolaNameTheorem}
\fi

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=darkblue!60!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=wildblueyonder!90!black,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{lemma}[theorem]{\nikolaNameLemma}

\theoremstyle{nikolatheononum}
\newmdtheoremenv[% settings
backgroundcolor=darkblue!60!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=wildblueyonder!90!black,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{lemma*}{\nikolaNameLemma}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=darkblue!60!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=wildblueyonder!90!black,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{corollary}[theorem]{\nikolaNameCorollary}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=darkblue!60!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=wildblueyonder!90!black,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{postulate}[theorem]{\nikolaNamePostulate}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=darkblue!60!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=wildblueyonder!90!black,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{prop}[theorem]{\nikolaNameProposition}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=darkblue!60!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=wildblueyonder!90!black,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{law}[theorem]{\nikolaNameLaw}

\theoremstyle{nikoladef}
\newmdtheoremenv[% settings
backgroundcolor=sangria!70!black,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=WildStrawberry!50!white,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{defn}{\nikolaNameDefinition}

\theoremstyle{nikolaexam}
\newmdtheoremenv[% settings
backgroundcolor=ForestGreen!50!black,
linecolor=thmgreen!90!black,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{example}[theorem]{\nikolaNameExample}

\theoremstyle{nikolamoral} 
\newmdtheoremenv[% settings
backgroundcolor=aqua!70!black,
linecolor=aqua!10,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{moral}{\nikolaNameMoral}

\theoremstyle{nikolaprob} 
\newmdtheoremenv[% settings
backgroundcolor=RoyalPurple,
linecolor=BlueViolet!10!white,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{problem}[theorem]{\nikolaNameProblem}

\theoremstyle{nikolafact}
\newmdtheoremenv[% settings
backgroundcolor=BurntOrange!50!black,
linecolor=Dandelion!50,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{fact}[theorem]{\nikolaNameFact}

\theoremstyle{nikolaexercise}
\newmdtheoremenv[% settings
nobreak=false,
innerleftmargin=0pt,
innerrightmargin=0pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{exercise}[theorem]{\nikolaNameExercise}

\theoremstyle{nikolaProblem}
\newmdtheoremenv[% settings
backgroundcolor=black,
nobreak=false,
innerleftmargin=0pt,
innerrightmargin=0pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{Problem}{\nikolaNameProblem}

\theoremstyle{nikolaProblemnonum}
\newmdtheoremenv[% settings
backgroundcolor=black,
nobreak=false,
innerleftmargin=0pt,
innerrightmargin=0pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{Problem*}{\nikolaNameProblem}

% \makeatletter
% \newcommand\asycode[2][]{%
%   \stepcounter{asy}%
%   \setkeys{ASYkeys}{#1}%
%   \ifASYattach
%     \ASYinlinefalse
%   \fi
%   \ifx\asydir\empty\else
%     \def\ASYprefix{\asydir/}%
%   \fi
%   \immediate\write\AsyPreStream{%
%     \noexpand\InputIfFileExists{%
%       \ASYprefix\noexpand\jobname-\the\c@asy.pre}{}{}%
%   }
%   \asy@write@graphic@header
%   \immediate\write\AsyStream{\detokenize{#2}}% here asy does the writing
%   \asy@finalise@stream
%   \asy@input@graphic
% }
% \makeatother

% \usepackage{environ}
% \NewEnviron{Problem}[1][]{
% \ifx&#1&%
%     \problem{\BODY}
% \else
%     \problem[#1]{\BODY}
% \fi
% }

\theoremstyle{nikolainduct}
\newmdtheoremenv[% settings
backgroundcolor=Cyan!50!CornflowerBlue!50!black,
linecolor=SkyBlue!35,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{basecase}{\nikolaNameBaseCase}

\theoremstyle{nikolainduct}
\newmdtheoremenv[% settings
backgroundcolor=Cyan!50!CornflowerBlue!50!black,
linecolor=SkyBlue!35,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{indstep}{\nikolaNameIndStep}

\theoremstyle{nikolacase}
\newmdtheoremenv[% settings
backgroundcolor=Magenta!50!CornflowerBlue!40!black,
linecolor=Magenta!45,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{case}{\nikolaNameCase}

\theoremstyle{nikolaremark}
\newmdtheoremenv[% settings
backgroundcolor=black!70,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=white,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{remark}[theorem]{\nikolaNameRemark}

\theoremstyle{nikolaremarknonum}
\newmdtheoremenv[% settings
backgroundcolor=black!70,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=white,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{remark*}[theorem]{\nikolaNameRemark}

% \theoremstyle{nikolaremark}
% \newmdtheoremenv[% settings
% backgroundcolor=black!70,
% nobreak=true,
% innertopmargin=5pt,
% innerleftmargin=7pt,
% innerrightmargin=7pt,
% linecolor=white,
% linewidth=3pt,
% topline=false,
% bottomline=false,
% rightline=false,
% leftline=true]{solution}[theorem]{Solution}

\newenvironment{exercisebox}{\begin{mdframed}[backgroundcolor=NavyBlue!30!black,linecolor=MidnightBlue!50,linewidth=1mm,topline=false,bottomline=false,leftline=true,rightline=false,
    innertopmargin=3pt,
    innerbottommargin=2pt,
    innerrightmargin=5pt,
    innerleftmargin=5pt]}{\end{mdframed}}
    
% \newenvironment{problembox}{\begin{mdframed}[backgroundcolor=WildStrawberry!10,linecolor=RedViolet,linewidth=0.3mm,topline=true,bottomline=true,leftline=true,rightline=true,
%     innertopmargin=3pt,
%     innerbottommargin=2pt,
%     innerrightmargin=5pt,
%     innerleftmargin=5pt]}{\end{mdframed}}

\newenvironment{problembox}{}{}
    
\theoremstyle{nikolawalk}

%%added walk for walkthroughs 
\newtheorem*{walk}{\nikolaNameWalk} % always use the enumerate environment during walkthroughs

% \def\walk{\noindent {\color{PineGreen}\sffamily\bfseries Walkthrough. }\hspace*{2mm}}

\usetikzlibrary{calc}
\usepackage{fourier-orns}
\definecolor{warningColor}{HTML}{FF1414}
\tikzset{
  warningsymbol/.style={
      circle,
      draw=black,
      fill=black,
      scale=1,
      overlay}
}

\mdfdefinestyle{warning}{%
 hidealllines=true,leftline=true,
 skipabove=12,skipbelow=12pt,
 backgroundcolor=black,
 innertopmargin=0.2em,%
 innerbottommargin=0.2em,%
 innerrightmargin=0.2em,%
 rightmargin=0.1em,%
 innerleftmargin=1.7em,%
 leftmargin=0.1em,%
 middlelinewidth=.2em,%
 linecolor=warningColor,%
 fontcolor=warningColor,%
 firstextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
 secondextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
 middleextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
 singleextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
}

\makeatletter
\@ifundefined{caution}{\newmdenv[style=warning]{caution}}{\renewmdenv[style=warning]{caution}}
\makeatother

\newcounter{question}
\newenvironment{question}{
\refstepcounter{question}\label{q\thequestion}%
\noindent%
\begin{addmargin}[0em]{0em}
  \makebox[0pt][r]{\tikz[baseline=(text.base)]{
    \coordinate (box top left) at (0, 0);
    \coordinate (box bottom right) at (3em, 1.2\baselineskip);
    \path[use as bounding box] (box top left) rectangle (box bottom right);
    \fill[opacity=0.8, RawSienna] (box top left) rectangle (box bottom right) node[midway, anchor=center](textpoint){};
    \node[anchor=center, text=RawSienna!10](text) at (textpoint) {\sffamily\arabic{question}};
    \path[draw=RawSienna!10, thick] let \p1 = (box top left), \p2 = (box bottom right) in (\p1) -- (\x2, \y1);
  }\hspace{1em}}%
}{
\end{addmargin}
\filbreak
}

\theoremstyle{nikolaclaim}
\newmdtheoremenv[% settings
backgroundcolor=NavyBlue!90!black,
linecolor=NavyBlue!5,
linewidth=1mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{claim}{\nikolaNameClaim}
\fi
\else
\ifnikolaolyretro
\ifnikolaolysecthm
\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retrolavender!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{theorem}{\nikolaNameTheorem}[section]
\else
\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retrolavender!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{theorem}{\nikolaNameTheorem}
\fi

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retrolavender!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{lemma}[theorem]{Lemma}

\theoremstyle{nikolatheononum}
\newmdtheoremenv[% settings
backgroundcolor=retrolavender!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{lemma*}{\nikolaNameLemma}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retrolavender!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{corollary}[theorem]{\nikolaNameCorollary}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retrolavender!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{postulate}[theorem]{\nikolaNamePostulate}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retrolavender!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{prop}[theorem]{\nikolaNameProposition}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=retrolavender!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retroblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{law}[theorem]{\nikolaNameLaw}

\theoremstyle{nikoladef}
\newmdtheoremenv[% settings
backgroundcolor=retropink!20!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=retropink,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{defn}{\nikolaNameDefinition}

\theoremstyle{nikolaexam}
\newmdtheoremenv[% settings
backgroundcolor=SpringGreen!10!white,
linecolor=retrogreen,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{example}[theorem]{\nikolaNameExample}

\theoremstyle{nikolamoral} 
\newmdtheoremenv[% settings
backgroundcolor=retrocyan!10,
linecolor=retrocyan,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{moral}{\nikolaNameMoral}

\theoremstyle{nikolaprob} 
\newmdtheoremenv[% settings
backgroundcolor=retropurple!10!white,
linecolor=retropurple,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{problem}[theorem]{\nikolaNameProblem}

\theoremstyle{nikolafact}
\newmdtheoremenv[% settings
backgroundcolor=retroorange!15,
linecolor=retroorange,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{fact}[theorem]{\nikolaNameFact}

\theoremstyle{nikolaexercise}
\newmdtheoremenv[% settings
nobreak=false,
innerleftmargin=0pt,
innerrightmargin=0pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{exercise}[theorem]{\nikolaNameExercise}

\theoremstyle{nikolaProblem}
\newmdtheoremenv[% settings
nobreak=false,
innerleftmargin=0pt,
innerrightmargin=0pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{Problem}{\nikolaNameProblem}

\theoremstyle{nikolaProblemnonum}
\newmdtheoremenv[% settings
nobreak=false,
innerleftmargin=0pt,
innerrightmargin=0pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{Problem*}{\nikolaNameProblem}

% \makeatletter
% \newcommand\asycode[2][]{%
%   \stepcounter{asy}%
%   \setkeys{ASYkeys}{#1}%
%   \ifASYattach
%     \ASYinlinefalse
%   \fi
%   \ifx\asydir\empty\else
%     \def\ASYprefix{\asydir/}%
%   \fi
%   \immediate\write\AsyPreStream{%
%     \noexpand\InputIfFileExists{%
%       \ASYprefix\noexpand\jobname-\the\c@asy.pre}{}{}%
%   }
%   \asy@write@graphic@header
%   \immediate\write\AsyStream{\detokenize{#2}}% here asy does the writing
%   \asy@finalise@stream
%   \asy@input@graphic
% }
% \makeatother

% \usepackage{environ}
% \NewEnviron{Problem}[1][]{
% \ifx&#1&%
%     \problem{\BODY}
% \else
%     \problem[#1]{\BODY}
% \fi
% }

\theoremstyle{nikolainduct}
\newmdtheoremenv[% settings
backgroundcolor=SkyBlue!15,
linecolor=Cyan!50!retrolazuli,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{basecase}{\nikolaNameBaseCase}

\theoremstyle{nikolainduct}
\newmdtheoremenv[% settings
backgroundcolor=SkyBlue!15,
linecolor=Cyan!50!retrolazuli,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{indstep}{\nikolaNameIndStep}

\theoremstyle{nikolacase}
\newmdtheoremenv[% settings
backgroundcolor=Magenta!15,
linecolor=Magenta!50!retrolazuli,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{case}{\nikolaNameCase}

\theoremstyle{nikolaremark}
\newmdtheoremenv[% settings
backgroundcolor=black!5,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=black,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{remark}[theorem]{\nikolaNameRemark}

\theoremstyle{nikolaremarknonum}
\newmdtheoremenv[% settings
backgroundcolor=black!5,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=black,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{remark*}[theorem]{\nikolaNameRemark}

% \theoremstyle{nikolaremark}
% \newmdtheoremenv[% settings
% backgroundcolor=Black!5,
% linecolor=Black,
% linewidth=0.3mm,
% nobreak=false,
% innerleftmargin=5pt,
% innerrightmargin=5pt,
% topline=true,
% bottomline=true,
% rightline=true,
% leftline=true]{solution}[theorem]{Solution}

\newenvironment{exercisebox}{\begin{mdframed}[backgroundcolor=retroindigo!10,linecolor=retroindigo,linewidth=1mm,topline=false,bottomline=false,leftline=true,rightline=false,
    innertopmargin=3pt,
    innerbottommargin=2pt,
    innerrightmargin=5pt,
    innerleftmargin=5pt]}{\end{mdframed}}
    
% \newenvironment{problembox}{\begin{mdframed}[backgroundcolor=WildStrawberry!10,linecolor=RedViolet,linewidth=0.3mm,topline=true,bottomline=true,leftline=true,rightline=true,
%     innertopmargin=3pt,
%     innerbottommargin=2pt,
%     innerrightmargin=5pt,
%     innerleftmargin=5pt]}{\end{mdframed}}

\newenvironment{problembox}{}{}
    
\theoremstyle{nikolawalk}

%%added walk for walkthroughs 
\newtheorem*{walk}{\nikolaNameWalk} % always use the enumerate environment during walkthroughs

% \def\walk{\noindent {\color{PineGreen}\sffamily\bfseries Walkthrough. }\hspace*{2mm}}

\usetikzlibrary{calc}
\usepackage{fourier-orns}
\definecolor{warningColor}{HTML}{AF2828}
\tikzset{
  warningsymbol/.style={
      circle,
      draw=white,
      fill=white,
      scale=1,
      overlay}
}

\mdfdefinestyle{warning}{%
 hidealllines=true,leftline=true,
 skipabove=12,skipbelow=12pt,
 innertopmargin=0.2em,%
 innerbottommargin=0.2em,%
 innerrightmargin=0.2em,%
 rightmargin=0.1em,%
 innerleftmargin=1.7em,%
 leftmargin=0.1em,%
 middlelinewidth=.2em,%
 linecolor=warningColor,%
 fontcolor=warningColor,%
 firstextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
 secondextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
 middleextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
 singleextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
}

\makeatletter
\@ifundefined{caution}{\newmdenv[style=warning]{caution}}{\renewmdenv[style=warning]{caution}}
\makeatother

\newcounter{question}
\newenvironment{question}{
\refstepcounter{question}\label{q\thequestion}%
\noindent%
\begin{addmargin}[0em]{0em}
  \makebox[0pt][r]{\tikz[baseline=(text.base)]{
    \coordinate (box top left) at (0, 0);
    \coordinate (box bottom right) at (3em, 1.2\baselineskip);
    \path[use as bounding box] (box top left) rectangle (box bottom right);
    \fill[opacity=0.1, Sepia] (box top left) rectangle (box bottom right) node[midway, anchor=center](textpoint){};
    \node[anchor=center, text=Sepia](text) at (textpoint) {\sffamily\arabic{question}};
    \path[draw=Sepia, thick] let \p1 = (box top left), \p2 = (box bottom right) in (\p1) -- (\x2, \y1);
  }\hspace{1em}}%
}{
\end{addmargin}
\filbreak
}

\theoremstyle{nikolaclaim}
\newmdtheoremenv[% settings
backgroundcolor=Emerald!5,
linecolor=Cyan!40!black,
linewidth=1mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{claim}{\nikolaNameClaim}
\else
\ifnikolaolysecthm
\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=wildblueyonder!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=darkblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{theorem}{\nikolaNameTheorem}[section]
\else
\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=wildblueyonder!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=darkblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{theorem}{\nikolaNameTheorem}
\fi

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=wildblueyonder!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=darkblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{lemma}[theorem]{Lemma}

\theoremstyle{nikolatheononum}
\newmdtheoremenv[% settings
backgroundcolor=wildblueyonder!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=darkblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{lemma*}{\nikolaNameLemma}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=wildblueyonder!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=darkblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{corollary}[theorem]{\nikolaNameCorollary}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=wildblueyonder!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=darkblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{postulate}[theorem]{\nikolaNamePostulate}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=wildblueyonder!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=darkblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{prop}[theorem]{\nikolaNameProposition}

\theoremstyle{nikolatheo}
\newmdtheoremenv[% settings
backgroundcolor=wildblueyonder!30!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=darkblue,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{law}[theorem]{\nikolaNameLaw}

\theoremstyle{nikoladef}
\newmdtheoremenv[% settings
backgroundcolor=WildStrawberry!20!white,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=sangria,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{defn}{\nikolaNameDefinition}

\theoremstyle{nikolaexam}
\newmdtheoremenv[% settings
backgroundcolor=thmgreen!50!white,
linecolor=ForestGreen,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{example}[theorem]{\nikolaNameExample}

\theoremstyle{nikolamoral} 
\newmdtheoremenv[% settings
backgroundcolor=aqua!10,
linecolor=aqua!95!black,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{moral}{\nikolaNameMoral}

\theoremstyle{nikolaprob} 
\newmdtheoremenv[% settings
backgroundcolor=BlueViolet!10!white,
linecolor=RoyalPurple,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{problem}[theorem]{\nikolaNameProblem}

\theoremstyle{nikolafact}
\newmdtheoremenv[% settings
backgroundcolor=Dandelion!15,
linecolor=BurntOrange,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{fact}[theorem]{\nikolaNameFact}

\theoremstyle{nikolaexercise}
\newmdtheoremenv[% settings
nobreak=false,
innerleftmargin=0pt,
innerrightmargin=0pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{exercise}[theorem]{\nikolaNameExercise}

\theoremstyle{nikolaProblem}
\newmdtheoremenv[% settings
nobreak=false,
innerleftmargin=0pt,
innerrightmargin=0pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{Problem}{\nikolaNameProblem}

\theoremstyle{nikolaProblemnonum}
\newmdtheoremenv[% settings
nobreak=false,
innerleftmargin=0pt,
innerrightmargin=0pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{Problem*}{\nikolaNameProblem}

% \makeatletter
% \newcommand\asycode[2][]{%
%   \stepcounter{asy}%
%   \setkeys{ASYkeys}{#1}%
%   \ifASYattach
%     \ASYinlinefalse
%   \fi
%   \ifx\asydir\empty\else
%     \def\ASYprefix{\asydir/}%
%   \fi
%   \immediate\write\AsyPreStream{%
%     \noexpand\InputIfFileExists{%
%       \ASYprefix\noexpand\jobname-\the\c@asy.pre}{}{}%
%   }
%   \asy@write@graphic@header
%   \immediate\write\AsyStream{\detokenize{#2}}% here asy does the writing
%   \asy@finalise@stream
%   \asy@input@graphic
% }
% \makeatother

% \usepackage{environ}
% \NewEnviron{Problem}[1][]{
% \ifx&#1&%
%     \problem{\BODY}
% \else
%     \problem[#1]{\BODY}
% \fi
% }

\theoremstyle{nikolainduct}
\newmdtheoremenv[% settings
backgroundcolor=SkyBlue!15,
linecolor=Cyan!50!CornflowerBlue,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{basecase}{\nikolaNameBaseCase}

\theoremstyle{nikolainduct}
\newmdtheoremenv[% settings
backgroundcolor=SkyBlue!15,
linecolor=Cyan!50!CornflowerBlue,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=false,
bottomline=false,
rightline=false,
leftline=false]{indstep}{\nikolaNameIndStep}

\theoremstyle{nikolacase}
\newmdtheoremenv[% settings
backgroundcolor=Magenta!15,
linecolor=Magenta!50!CornflowerBlue,
linewidth=0.3mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=true,
bottomline=true,
rightline=true,
leftline=true]{case}{\nikolaNameCase}

\theoremstyle{nikolaremark}
\newmdtheoremenv[% settings
backgroundcolor=black!5,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=black,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{remark}[theorem]{\nikolaNameRemark}

\theoremstyle{nikolaremarknonum}
\newmdtheoremenv[% settings
backgroundcolor=black!5,
nobreak=true,
innertopmargin=5pt,
innerleftmargin=7pt,
innerrightmargin=7pt,
linecolor=black,
linewidth=3pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{remark*}[theorem]{\nikolaNameRemark}

% \theoremstyle{nikolaremark}
% \newmdtheoremenv[% settings
% backgroundcolor=Black!5,
% linecolor=Black,
% linewidth=0.3mm,
% nobreak=false,
% innerleftmargin=5pt,
% innerrightmargin=5pt,
% topline=true,
% bottomline=true,
% rightline=true,
% leftline=true]{solution}[theorem]{Solution}

\newenvironment{exercisebox}{\begin{mdframed}[backgroundcolor=MidnightBlue!10,linecolor=NavyBlue,linewidth=1mm,topline=false,bottomline=false,leftline=true,rightline=false,
    innertopmargin=3pt,
    innerbottommargin=2pt,
    innerrightmargin=5pt,
    innerleftmargin=5pt]}{\end{mdframed}}
    
% \newenvironment{problembox}{\begin{mdframed}[backgroundcolor=WildStrawberry!10,linecolor=RedViolet,linewidth=0.3mm,topline=true,bottomline=true,leftline=true,rightline=true,
%     innertopmargin=3pt,
%     innerbottommargin=2pt,
%     innerrightmargin=5pt,
%     innerleftmargin=5pt]}{\end{mdframed}}

\newenvironment{problembox}{}{}
    
\theoremstyle{nikolawalk}

%%added walk for walkthroughs 
\newtheorem*{walk}{\nikolaNameWalk} % always use the enumerate environment during walkthroughs

% \def\walk{\noindent {\color{PineGreen}\sffamily\bfseries Walkthrough. }\hspace*{2mm}}

\usetikzlibrary{calc}
\usepackage{fourier-orns}
\definecolor{warningColor}{HTML}{FF1414}
\tikzset{
  warningsymbol/.style={
      circle,
      draw=white,
      fill=white,
      scale=1,
      overlay}
}

\mdfdefinestyle{warning}{%
 hidealllines=true,leftline=true,
 skipabove=12,skipbelow=12pt,
 innertopmargin=0.2em,%
 innerbottommargin=0.2em,%
 innerrightmargin=0.2em,%
 rightmargin=0.1em,%
 innerleftmargin=1.7em,%
 leftmargin=0.1em,%
 middlelinewidth=.2em,%
 linecolor=warningColor,%
 fontcolor=warningColor,%
 firstextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
 secondextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
 middleextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
 singleextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[warningsymbol] {\faWarning};},%
}

\makeatletter
\@ifundefined{caution}{\newmdenv[style=warning]{caution}}{\renewmdenv[style=warning]{caution}}
\makeatother

\newcounter{question}
\newenvironment{question}{
\refstepcounter{question}\label{q\thequestion}%
\noindent%
\begin{addmargin}[0em]{0em}
  \makebox[0pt][r]{\tikz[baseline=(text.base)]{
    \coordinate (box top left) at (0, 0);
    \coordinate (box bottom right) at (3em, 1.2\baselineskip);
    \path[use as bounding box] (box top left) rectangle (box bottom right);
    \fill[opacity=0.1, RawSienna] (box top left) rectangle (box bottom right) node[midway, anchor=center](textpoint){};
    \node[anchor=center, text=RawSienna](text) at (textpoint) {\sffamily\arabic{question}};
    \path[draw=RawSienna, thick] let \p1 = (box top left), \p2 = (box bottom right) in (\p1) -- (\x2, \y1);
  }\hspace{1em}}%
}{
\end{addmargin}
\filbreak
}

\theoremstyle{nikolaclaim}
\newmdtheoremenv[% settings
backgroundcolor=NavyBlue!5,
linecolor=NavyBlue!90!black,
linewidth=1mm,
nobreak=false,
innerleftmargin=5pt,
innerrightmargin=5pt,
topline=false,
bottomline=false,
rightline=false,
leftline=true]{claim}{Claim}
\fi
\fi

% \usepackage{minted} % commented out for write18 reasons
% \usemintedstyle{manni}

\ifnikolaolydarkmode
\newenvironment{boxpar}[1][]{%
\begin{mdframed}[nobreak=false,backgroundcolor=black,linecolor=white]\vspace*{-0.5cm}\paragraph{\color{\maincolor}\sffamily #1}\color{white}
}{\end{mdframed}}

\usetikzlibrary{calc,arrows}
\tikzset{
    excursus arrow/.style={%
        line width=2pt,
        draw=\secondcolor,
        rounded corners=2ex,
    },
    excursus head/.style={
        fill=black,
        font=\bfseries\sffamily,
        text=white,
        anchor=base west,
    },
}

\mdfdefinestyle{arrowbox}{%
  linecolor=\secondcolor,
  linewidth=1.5pt,
  backgroundcolor=black,
  roundcorner=6pt,
  topline=true,bottomline=true,leftline=true,rightline=true,
  innerleftmargin=2ex,innerrightmargin=2ex,innertopmargin=1ex,innerbottommargin=1ex,
  skipabove=0.87\baselineskip,
  skipbelow=0.62\baselineskip,
}

\declaretheoremstyle[
	headfont=\sffamily\bfseries\color{\secondcolor},
	mdframed={style=arrowbox,backgroundcolor=black},
	headpunct={},
	postheadspace={0pt}
]{arrows}

\declaretheorem[style=arrows,name=\nikolaNameNotation,numbered=no]{notationbox}

\newenvironment{notation}{
\begin{notationbox}~
\color{white}
\begin{itemize}    
}{
\end{itemize}
\end{notationbox}
}
\else
\newenvironment{boxpar}[1][]{%
\begin{mdframed}[nobreak=false]\vspace*{-0.5cm}\paragraph{\color{\maincolor}\sffamily #1}
}{\end{mdframed}}

\usetikzlibrary{calc,arrows}
\tikzset{
    excursus arrow/.style={%
        line width=2pt,
        draw=\secondcolor,
        rounded corners=2ex,
    },
    excursus head/.style={
        fill=white,
        font=\bfseries\sffamily,
        text=black!80,
        anchor=base west,
    },
}

\mdfdefinestyle{arrowbox}{%
  linecolor=\secondcolor,
  linewidth=2pt,
  backgroundcolor=white,
  roundcorner=6pt,
  topline=true,bottomline=true,leftline=true,rightline=true,
  innerleftmargin=2ex,innerrightmargin=2ex,innertopmargin=1ex,innerbottommargin=1ex,
  skipabove=0.87\baselineskip,
  skipbelow=0.62\baselineskip,
}

\declaretheoremstyle[
	headfont=\sffamily\bfseries\color{\secondcolor},
	mdframed={style=arrowbox},
	headpunct={},
	postheadspace={0pt}
]{arrows}

\declaretheorem[style=arrows,name=\nikolaNameNotation,numbered=no]{notationbox}

\newenvironment{notation}{
\begin{notationbox}~
\begin{itemize}    
}{
\end{itemize}
\end{notationbox}
}
\fi

\newenvironment{keywords}{\begin{abstract} \sffamily\small \textbf{Keywords:}}{\end{abstract}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Theorem
\newcounter{theo}[section] \setcounter{theo}{0}
\renewcommand{\thetheo}{\thetheorem}
\newenvironment{theo}[1][]{%
\refstepcounter{theorem}%
\ifstrempty{#1}%
{\mdfsetup{%
frametitle={%
\tikz[baseline=(current bounding box.east),outer sep=0pt]
\node[anchor=east,rectangle,fill=blue!20]
{\strut \sffamily \color{blue!70!black} \nikolaNameTheorem~\thetheo};}}
}%
{\mdfsetup{%
frametitle={%
\tikz[baseline=(current bounding box.east),outer sep=0pt]
\node[anchor=east,rectangle,fill=blue!20]
{\strut \sffamily \color{blue!70!black} \nikolaNameTheorem~\thetheo~(#1)};}}%
}%
\mdfsetup{innertopmargin=10pt,linecolor=blue!20,%
linewidth=2pt,topline=true,%
frametitleaboveskip=\dimexpr-\ht\strutbox\relax
}
\begin{mdframed}[]\relax%
}{\end{mdframed}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Example
\newcounter{exam}[section] \setcounter{exam}{0}
\renewcommand{\theexam}{\thetheorem}
\newenvironment{exam}[1][]{%
\refstepcounter{theorem}%
\ifstrempty{#1}%
{\mdfsetup{%
frametitle={%
\tikz[baseline=(current bounding box.east),outer sep=0pt]
\node[anchor=east,rectangle,fill=green!20]
{\strut \sffamily \color{ForestGreen!70!black} \nikolaNameExample~\theexam};}}
}%
{\mdfsetup{%
frametitle={%
\tikz[baseline=(current bounding box.east),outer sep=0pt]
\node[anchor=east,rectangle,fill=green!20]
{\strut \sffamily \color{ForestGreen!70!black} \nikolaNameExample~\theexam~(#1)};}}%
}%
\mdfsetup{innertopmargin=10pt,linecolor=green!20,%
linewidth=2pt,topline=true,%
frametitleaboveskip=\dimexpr-\ht\strutbox\relax
}
\begin{mdframed}[]\relax%
}{\end{mdframed}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Definition
\newcounter{defi}[section]\setcounter{defi}{0}
\renewcommand{\thedefi}{\thetheorem}
\newenvironment{defi}[1][]{%
\refstepcounter{theorem}%
\ifstrempty{#1}%
{\mdfsetup{%
frametitle={%
\tikz[baseline=(current bounding box.east),outer sep=0pt]
\node[anchor=east,rectangle,fill=red!20]
{\strut \sffamily \color{red!70!black} Definition~\thedefi};}}
}%
{\mdfsetup{%
frametitle={%
\tikz[baseline=(current bounding box.east),outer sep=0pt]
\node[anchor=east,rectangle,fill=red!20]
{\strut \sffamily \color{red!70!black} Definition~\thedefi~(#1)};}}%
}%
\mdfsetup{innertopmargin=10pt,linecolor=red!20,%
linewidth=2pt,topline=true,%
frametitleaboveskip=\dimexpr-\ht\strutbox\relax
}
\begin{mdframed}[]\relax%
}{\end{mdframed}}

%%%%%%%
%PROBLEMS%
%%%%%%%

\RequirePackage{adjustbox} % needs adjustbox
\ifnikolaolyskak
\newcommand{\pawnB}[1][1.3ex]{%
\adjustbox{Trim=4.3pt 2.6pt 4.3pt 0pt,width=#1,raise=-0.15ex,margin=0.1ex 0ex 0.1ex 0ex}{\BlackPawnOnWhite}%
}%
\newcommand{\rookB}[1][1.58ex]{%
\adjustbox{Trim=3.2pt 2.2pt 3.2pt 0pt,width=#1,raise=-0.2ex,margin=0.1ex 0ex 0.1ex 0ex}{\BlackRookOnWhite}%
}%
\newcommand{\knightB}[1][1.85ex]{%
\adjustbox{Trim=2.3pt 2.35pt 2.5pt 0pt,width=#1,raise=-0.03ex,margin=0.14ex 0ex 0.14ex 0ex}{\BlackKnightOnWhite}%
}%
\newcommand{\bishopB}[1][1.79ex]{%
\adjustbox{Trim=2.3pt 2pt 2.3pt 0pt,width=#1,raise=-0.12ex,margin=0.1ex 0ex 0.1ex 0ex}{\BlackBishopOnWhite}%
}%
\newcommand{\queenB}[1][2.05ex]{%
\adjustbox{Trim=1.2pt 2.2pt 1.2pt 0pt,width=#1,raise=-0.08ex,margin=0.1ex 0ex 0.1ex 0ex}{\BlackQueenOnWhite}%
}%
\newcommand{\kingB}[1][1.95ex]{%
\adjustbox{Trim=2pt 2pt 2pt 0pt,width=#1,raise=-0.06ex,margin=0.13ex 0ex 0.13ex 0ex}{\BlackKingOnWhite}%
}%
\else
\newcommand{\pawnB}[1][1.3ex]{\text{\bfseries P}}%
\newcommand{\rookB}[1][1.58ex]{\text{\bfseries R}}%
\newcommand{\knightB}[1][1.85ex]{\text{\bfseries N}}%
\newcommand{\bishopB}[1][1.79ex]{\text{\bfseries B}}%
\newcommand{\queenB}[1][2.05ex]{\text{\bfseries Q}}%
\newcommand{\kingB}[1][1.95ex]{\text{\bfseries K}}%
\fi

% convenience macros

\newcommand{\probSymb}{\pawnB}
\newcommand{\reqSymb}{\rookB}

% page setup

\newcommand{\problems}{\pagebreak\section{\nikolaNameProblems}}

\ifnikolaolydarkmode
\newcommand{\psetquote}[2] % BE CAREFUL WITH THIS. must be DIRECTLY after minpt
{
\begin{flushright}
\begin{tikzpicture}
\draw (0,0) node [right,text width=8.75cm]{
\begin{mdframed}[linecolor=\maincolor!30,leftline=true,rightline=false,bottomline=false,topline=false,linewidth=3pt,backgroundcolor=\maincolor!30!black]
{\sffamily\color{white}``#1''}

\vspace{1mm}

\hfill\color{\maincolor!70}\textit{#2}
\end{mdframed}
};

\end{tikzpicture}
\end{flushright}
}
\else
\newcommand{\psetquote}[2] % BE CAREFUL WITH THIS. must be DIRECTLY after minpt
{
\begin{flushright}
\begin{tikzpicture}
\draw (0,0) node [right,text width=8.75cm]{
\begin{mdframed}[linecolor=\maincolor!90,leftline=true,rightline=false,bottomline=false,topline=false,linewidth=3pt,backgroundcolor=\maincolor!5]
{\sffamily``#1''}

\vspace{1mm}

\hfill\color{\maincolor!70!black}\textit{#2}
\end{mdframed}
};

\end{tikzpicture}
\end{flushright}
}
\fi

% actual problems

\newcounter{probcnt}

\ifnikolaolynopts
\newcommand{\minpt}[1]{}

\newcommand{\prob}[3][]{
\stepcounter{Problem}
{
{\noindent\notofont\color{\maincolor}\textbf{\nikolaNameProblem\ \theProblem\if\relax\detokenize{#2}\else\hspace{3pt}(#2)\fi.}}{\hspace{3pt}#3}
\vspace{0.2cm}
}
}

\newcommand{\req}[3][]{
\stepcounter{Problem}
{\noindent
{\notofont\color{\maincolor}\textbf{\nikolaNameProblem\ \theProblem\if\relax\detokenize{#2}\else\hspace{3pt}(#2)\fi.}}{\hspace{3pt}#3}
\vspace{0.2cm}
}
}
\else
\newcommand{\minpt}[1]{%
  \noindent\textsf{%
    \ifnikolaolybulgarian
      Минимумът е {\color{\maincolor}\notofont\bfseries[#1\,\probSymb]}. %
      Задачите, отбелязани с {\color{\maincolor!50!white}\reqSymb}, са задължителни (броят се към точките).%
    \else
      Minimum is {\color{\maincolor}\notofont\bfseries[#1\,\probSymb]}. Problems denoted with {\color{\maincolor!50!white}\reqSymb} are required. (They still count towards the point total.)%
    \fi
  }%
}

\newcommand{\prob}[3][]{
\stepcounter{Problem}
{\noindent
{\notofont\color{\maincolor}\if\relax\detokenize{#1}\else\textbf{\small{[#1\,\probSymb}]} \fi \textbf{\nikolaNameProblem\ \theProblem\if\relax\detokenize{#2}\else\hspace{3pt}(#2)\fi.}}{\hspace{3pt}#3}
\vspace{0.2cm}
}
}

\newcommand{\req}[3][]{
\stepcounter{Problem}
{\noindent
{\notofont\color{\maincolor!50!white}\if\relax\detokenize{#1}\else\textbf{\small{[#1\,\reqSymb]}} \fi \textbf{\nikolaNameProblem\ \theProblem\if\relax\detokenize{#2}\else\hspace{3pt}(#2)\fi.}}{\hspace{3pt}#3}
\vspace{0.2cm}
}
}
\fi

\renewcommand{\problem}[2][]{
\prob{#1}{#2}
}

\usepackage{marvosym}
\tikzset{
  lightningsymbol/.style={
      circle,
      scale=1,
      overlay}
}
\ifnikolaolydarkmode
\newenvironment{hardbox}{\begin{mdframed}[backgroundcolor=\maincolor!30!black,linecolor=\maincolor!30,linewidth=1mm,topline=false,bottomline=false,leftline=true,rightline=false,
    innertopmargin=3pt,
    innerbottommargin=2pt,
    innerrightmargin=5pt,
    innerleftmargin=5pt,firstextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[lightningsymbol] {\Huge\hspace*{-1cm}\textcolor{\maincolor}{\Lightning}};},
    secondextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[lightningsymbol] {\Huge\hspace*{-1cm}\textcolor{\maincolor}{\Lightning}};},
    middleextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[lightningsymbol] {\Huge\hspace*{-1cm}\textcolor{\maincolor}{\Lightning}};},
    singleextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[lightningsymbol] {\Huge\hspace*{-1cm}\textcolor{\maincolor}{\Lightning}};},]\color{white}}{\end{mdframed}}
\else
\newenvironment{hardbox}{\begin{mdframed}[backgroundcolor=\maincolor!10,linecolor=\maincolor,linewidth=1mm,topline=false,bottomline=false,leftline=true,rightline=false,
    innertopmargin=3pt,
    innerbottommargin=2pt,
    innerrightmargin=5pt,
    innerleftmargin=5pt,firstextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[lightningsymbol] {\Huge\hspace*{-1cm}\textcolor{\maincolor}{\Lightning}};},
    secondextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[lightningsymbol] {\Huge\hspace*{-1cm}\textcolor{\maincolor}{\Lightning}};},
    middleextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[lightningsymbol] {\Huge\hspace*{-1cm}\textcolor{\maincolor}{\Lightning}};},
    singleextra={\path let \p1=(P), \p2=(O) in ($(\x2,0)+0.5*(0,\y1)$) 
                           node[lightningsymbol] {\Huge\hspace*{-1cm}\textcolor{\maincolor}{\Lightning}};},]}{\end{mdframed}}
\fi


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%fakesection Asymptote setup
\ifnikolaolyasy
  \IfFileExists{asymptote.sty}{%
    \ifnikolaolypatchasy
      \usepackage{patch-asy}
    \else
      \usepackage{asymptote}
    \fi
  }{%
    \PackageWarning{nikolaoly}{asymptote.sty not found; disabling Asymptote support}%
    \nikolaolyasyfalse
  }%
\fi
\ifnikolaolythm
	\usepackage{amsthm}
\fi

%%fakesection BEGIN MAIN SETUP
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\makeatletter

\ifnikolaolysetup
	%%fakesection Set up author and date
	% \ifnikolaolyauthor
	%	\AtBeginDocument {%
	%		\author{Nikola Yu}
	%		\date{\today}
	%	}
	% \fi
	%%fakesection Hyperref
	\ifnikolaolypkg
		\PassOptionsToPackage{usenames,svgnames,dvipsnames}{xcolor}
		\usepackage{xcolor}
		\ifnikolaolyhref
			\usepackage[colorlinks=true]{hyperref}
			\hypersetup{urlcolor=RoyalPurple,linkcolor=Ultra,citecolor=SkyBlue2}
		\fi
		\usepackage[nameinlink]{cleveref}
	\fi

\definecolor{Purple06}{RGB}{029, 002, 053}
\definecolor{Purple05}{RGB}{038, 008, 065}
\definecolor{Purple04}{RGB}{048, 016, 078}
\definecolor{Purple03}{RGB}{056, 023, 090}
\definecolor{Purple02}{RGB}{064, 031, 104}
\definecolor{Purple01}{RGB}{072, 036, 118}
\definecolor{Violet001}{RGB}{120,100,163}
		
\fi


	\ifnikolaolycolorsec
		\@ifundefined{KOMAClassName}{}{
			\@ifundefined{chapter}{}{
				 \addtokomafont{partprefix}{\rmfamily}
				\renewcommand*{\partformat}{\color{\secondcolor}
					\scalebox{2.5}{\thepart}\enlargethispage{2em}}
				\addtokomafont{chapterprefix}{\raggedleft}
				\RedeclareSectionCommand[beforeskip=0.4em]{chapter}
				\renewcommand*{\chapterformat}{\mbox{%
					\scalebox{1.5}{\chapappifchapterprefix{\nobreakspace}}%
					\scalebox{2.72}{\color{\maincolor}\thechapter}\enskip}}
			}
	
			
		\ifnikolaolysectionleaves
			\renewcommand*{\sectionformat}%
				{\color{\maincolor}\faEnvira\thesection\enskip}
			\renewcommand*{\subsectionformat}%
				{\color{\maincolor}\faEnvira\thesubsection\enskip}
			\renewcommand*{\subsubsectionformat}%
				{\color{\maincolor}\faEnvira\thesubsubsection\enskip}
		\else
			\renewcommand*{\sectionformat}%
				{\color{\maincolor}\thesection\enskip}
			\renewcommand*{\subsectionformat}%
				{\color{\maincolor}\thesubsection\enskip}
			\renewcommand*{\subsubsectionformat}%
				{\color{\maincolor}\thesubsubsection\enskip}
		\fi
		}
	\fi


	%%fakesection Loads a bunch of useful packages (but allow disabling)
	\ifnikolaolypkg
		\IfFileExists{von.sty}{\usepackage{von}}{}
		\usepackage{listings}
		\usepackage{mathrsfs}
		\usepackage{textcomp}
		\lstset{basicstyle=\footnotesize\ttfamily,
			numbers=left,
			numbersep=5pt,
			numberstyle=\tiny,
			keywordstyle=\bfseries,
			% title=\lstname,
			showstringspaces=false,
			tabsize=4,
			frame=single,
			keywordstyle=\bfseries\color{blue},
			commentstyle=\color{green!70!black},
			identifierstyle=\color{green!20!black},
			stringstyle=\color{orange},
			breaklines=true,
			breakatwhitespace=true,
			frame=none
		}
		\usepackage[shortlabels]{enumitem}
		% a list I like for walkthrough's --- Drew-style parts
		\usepackage[obeyFinal,textsize=scriptsize,shadow]{todonotes}
		\usepackage{textcomp}
		\usepackage{multirow}
		% Tiny tiny optimizations:
		\usepackage{mathtools}
		\usepackage{microtype}
	\fi

	%%fakesection \maketitle configuration
	\@ifundefined{KOMAClassName}%
		{} % do nothing outside KOMA class
		{% If KOMA exists. . .
		\addtokomafont{subtitle}{\Large\merri\color{\maincolor}}
		\setkomafont{author}{\Large\scshape}
		\setkomafont{date}{\Large\normalsize}
		}
	\providecommand{\thetitle}{\@title}
	\providecommand{\theauthor}{\@author}
	\providecommand{\thedate}{\@date}
	
  \patchcmd{\@maketitle}{\@title}{\merri\color{\maincolor}\bfseries\@title}{}{}
  \patchcmd{\@maketitle}{\@author}{\merri\@author}{}{}
  \patchcmd{\@maketitle}{\@date}{\merri\color{\maincolor}{\@date}}{}{}

	%%fakesection Commutative diagrams support
	\ifnikolaolydiagrams
		\usepackage{diagrams}
		\newarrow{Inj}C--->
		\newarrow{Surj}----{>>}
		\newarrow{Proj}----{>>}
		\newarrow{Embed}>--->
		\newarrow{Incl}C--->
		\newarrow{Mapsto}|--->
		\newarrow{Isom}<--->
		\newarrow{Dotted}....>
		\newarrow{Dashed}{}{dash}{}{dash}>
		\newarrow{Line}-----
		\usepackage{tikz-cd}
		\usetikzlibrary{decorations.pathmorphing}
		\tikzcdset{row sep/normal=3.14em,column sep/normal=3.14em}
	\fi

	%%fakesection Page Setup
	\ifnikolaolyfancy
		\@ifundefined{KOMAClassName}
		{
		    \usepackage{fancyhdr}
			\setlength{\headheight}{0.75in}
			\setlength{\oddsidemargin}{0in}
			\setlength{\evensidemargin}{0in}
			\setlength{\voffset}{-1.0in}
			\setlength{\headsep}{10pt}
			\setlength{\textwidth}{6.5in}
			\setlength{\headwidth}{6.5in}
			\setlength{\textheight}{8.75in}
			\setlength{\parskip}{1ex plus 0.5ex minus 0.2ex}
			\setlength{\footskip}{0.3in}
			\ifnikolaolyhdr
				\renewcommand{\headrulewidth}{0.5pt}
				\renewcommand{\footrulewidth}{0.0pt}
				\pagestyle{fancy}
				\lhead{Nikola Yu}
				\chead{}
				\rhead{\nouppercase{\leftmark}}
				\lfoot{}
				\cfoot{\thepage}
				\rfoot{}
			\fi
		}
		
		
			\usepackage[headsepline]{scrlayer-scrpage}
			\renewcommand{\headfont}{}
			\addtolength{\textheight}{3cm}
			\setlength{\footskip}{0.2in}
			\setlength{\headsep}{10pt}
			\setlength{\headheight}{26pt}
			\ihead{\sffamily\footnotesize\textbf{\theauthor} \textbf{\textcolor{\maincolor}{(\thedate )}}}
			\chead{}
			\cfoot{}
			\ohead{\sffamily\footnotesize\textbf{\thetitle}}
			\ofoot{\thepage}
		
		
		
		
	\fi
	%%fakesection Hints
	\ifnikolaolyhints
		\usepackage{answers}
		\Newassociation{hint}{hintitem}{hints}
		\renewcommand{\solutionextension}{out}
		\Opensolutionfile{hints}
		\newcommand{\makehints}{\Closesolutionfile{hints}\input{hints.out}} % chktex 27
	\fi
\makeatother
%%fakesection END MAIN SETUP

\usepackage{multicol}
\usepackage{afterpage}
\usepackage{pagecolor}
\usepackage{ytableau}
\usepackage{tikzducks}
% \colorlet{titlepagecolor}{\maincolor}
\usepackage{multirow}
\usepackage{mdframed}

\usetikzlibrary{arrows, automata}

\ifnikolaolytitledecorations
\renewcommand\titlepagedecoration{%
\begin{tikzpicture}[remember picture,overlay,shorten >= -10pt]

\coordinate (aux1) at ([yshift=-15pt]current page.north east);
\coordinate (aux2) at ([yshift=-410pt]current page.north east);
\coordinate (aux3) at ([xshift=-4.5cm]current page.north east);
\coordinate (aux4) at ([yshift=-150pt]current page.north east);

\begin{scope}[\maincolor!63,line width=12pt,rounded corners=12pt]

\draw[\maincolor!63]
  (aux1) -- coordinate (a) 
  ++(225:5) --
  ++(-45:5.1) coordinate (b);
\draw[shorten <= -10pt]
  (aux3) --
  (a) --
  (aux1);
\draw[opacity=0.6,\secondcolor!50!\maincolor,shorten <= -10pt]
  (b) --
  ++(225:2.2) --
  ++(-45:2.2);
\end{scope}
\draw[\maincolor!70!\secondcolor,line width=8pt,rounded corners=8pt,shorten <= -10pt]
  (aux4) --
  ++(225:0.8) --
  ++(-45:0.8);
\begin{scope}[\secondcolor!70,line width=6pt,rounded corners=8pt]
\draw[shorten <= -10pt]
  (aux2) --
  ++(225:3) coordinate[pos=0.45] (c) --
  ++(-45:3.1);
\draw[\secondcolor!80!\maincolor]
  (aux2) --
  (c) --
  ++(135:2.5) --
  ++(45:2.5) --
  ++(-45:2.5) coordinate[pos=0.3] (d);   
\draw[\secondcolor!65!\maincolor]
  (d) -- +(45:1);
  
\end{scope}
\end{tikzpicture}%
}
\else
\renewcommand\titlepagedecoration{}%
\fi

\usepackage[prefix=]{xcolor-material}
\pgfmathdeclarerandomlist{material}{%
{Red}{Blue}{Green}}
\tikzset{%
  half clip/.code={
    \clip (0, -256) rectangle (256, 256);
  },
  color/.code=\colorlet{fill color}{#1},
  color alias/.code args={#1 as #2}{\colorlet{#1}{#2}},
  colors alias/.style={color alias/.list/.expanded={#1}},
  execute/.code={#1},
  on left/.style={.. on left/.style={#1}},
  on right/.style={.. on right/.style={#1}},
  split/.style args={#1 and #2}{
    on left ={color alias=fill color as #1},
    on right={color alias=fill color as #2, half clip}
  }
}
\newcommand\reflect[2][]{%
\begin{scope}[#1]\foreach \side in {-1, 1}{\begin{scope}
\ifnum\side=-1 \tikzset{.. on left/.try}\else\tikzset{.. on right/.try}\fi
\begin{scope}[xscale=\side]#2\end{scope}
\end{scope}}\end{scope}}

\tikzset{%
squid/.pic={
\begin{scope}[x=3cm/480,y=3cm/480]
\useasboundingbox (-256, -256) (256, 256);
\reflect[split={DeepOrange500 and DeepOrange700}]{
  \fill [fill color] (0,96) ellipse [x radius=97, y radius=127];
  \fill [fill color]
    (72,-16)
    .. controls ++(270:72) and ++(270:40) .. ++(108,  -16)
    .. controls ++( 90:64) and ++(270:64) .. ++(-40,128)
    .. controls ++( 90:32) and ++(270:32) .. ++( 40, 96)
    arc (180:0:4)
    .. controls ++(270: 32) and ++( 90: 32) .. ++(-24, -96)
    .. controls ++(270: 64) and ++( 90: 64) .. ++( 56,-128)
    .. controls ++(270:128) and ++(270:160) ..   (  0, -16);
  \fill [fill color]  (64, 16) circle [radius=48];
  \fill [Grey50]      (64, 16) circle [radius=32];
  \fill [BlueGrey900] (64, 16) circle [radius=12];
  \fill [fill color]  (-4, -20)
    .. controls ++(270:256) and ++(225: 64) .. (128,-192)
    arc (315:495:4)
    .. controls ++(210: 64) and ++(270:192) .. (48, -40);
}
\fill [DeepOrange900]
  (-40,-40) arc (180:360:40 and 16) arc (360:180:40 and 40);
\fill [DeepOrange300]
  (-32,108) circle [radius=16] (-40,160) circle [radius=12]
  (-20,196) circle [radius= 8]  ( 40,160) circle [radius=16]
  ( 64,120) circle [radius= 8]  ( 40,100) circle [radius=12];
\end{scope}
}
}
\newcommand{\tikznode}[2]{\tikz[remember picture,baseline=(#1.base),inner
 sep=0pt]{\node(#1)[inner sep=0pt]{#2};}}

\definecolor{purple11}{RGB}{51, 0, 102}
\definecolor{Ultra1}{RGB}{18, 10, 142}
\definecolor{SteelBlue}{RGB}{70,130,180}


\newcommand{\chapquote}[3]{\begin{quotation} \textcolor{SteelBlue}{\textsl{#1}} \end{quotation} \begin{flushright} - \textcolor{SteelBlue}{#2} \textit{#3}\end{flushright} }

%%% TITLE
% Ensure decoration macro exists, then redefine \nikolatitle to apply it with empty page style
\providecommand{\titlepagedecoration}{}
\renewcommand{\nikolatitle}{%
  \maketitle
    \titlepagedecoration
    \thispagestyle{empty}%
}

\usepackage[T1]{fontenc}
% mathpazo (Palatino) lacks T2A; skip when Bulgarian is active to avoid warnings
\ifnikolaolybulgarian\else
  \usepackage{mathpazo}
\fi

\usepackage{tikz, tikz-cd, pgfplots} 
\usepgfplotslibrary{fillbetween}
\usetikzlibrary{arrows.meta,arrows,scopes,patterns,shapes.geometric,angles,quotes,intersections,calc}
\makeatletter
\tikzset{% https://tex.stackexchange.com/a/142491
  mirror/.code={\pgfutil@in@{--}{#1}\ifpgfutil@in@\tikz@trans@mirror#1\@nil
    \else\tikz@scan@one@point\pgftransformmirror#1\relax\fi},
  ymirror/.code={\pgfutil@ifnextchar(\tikz@trans@ymirror@coordinate\tikz@trans@ymirror@simple#1\@nil},
  xmirror/.code={\pgfutil@ifnextchar(\tikz@trans@xmirror@coordinate\tikz@trans@xmirror@simple#1\@nil}}
\def\tikz@trans@mirror#1--#2\@nil{%
  \pgfextract@process\pgf@trans@mirror@A{\tikz@scan@one@point\pgfutil@firstofone#1}%
  \pgfextract@process\pgf@trans@mirror@B{\tikz@scan@one@point\pgfutil@firstofone#2}%
  \pgftransformMirror{\pgf@trans@mirror@A}{\pgf@trans@mirror@B}}
\def\pgftransformxmirror#1{\pgfmathparse{2*(#1)}\pgftransformcm{-1}{0}{0}{1}{\pgfqpoint{+\pgfmathresult pt}{+0pt}}}
\def\pgftransformymirror#1{\pgfmathparse{2*(#1)}\pgftransformcm{1}{0}{0}{-1}{\pgfqpoint{+0pt}{+\pgfmathresult pt}}}
\def\tikz@trans@ymirror@simple#1\@nil{
  \pgfmathparse{#1}\let\tikz@temp\pgfmathresult
  \ifpgfmathunitsdeclared
    \pgftransformymirror{\tikz@temp pt}%
  \else
    \pgf@process{\pgfpointxy{0}{\tikz@temp}}%
    \pgftransformymirror{+\the\pgf@y}%
  \fi}
\def\tikz@trans@xmirror@simple#1\@nil{
  \pgfmathparse{#1}\let\tikz@temp\pgfmathresult
  \ifpgfmathunitsdeclared
    \pgftransformxmirror{\tikz@temp pt}%
  \else
    \pgf@process{\pgfpointxy{\tikz@temp}{0}}%
    \pgftransformxmirror{+\the\pgf@x}%
  \fi}
\def\tikz@trans@xmirror@coordinate#1\@nil{\tikz@scan@one@point\pgfutil@firstofone#1\pgftransformxmirror{+\the\pgf@x}}
\def\tikz@trans@ymirror@coordinate#1\@nil{\tikz@scan@one@point\pgfutil@firstofone#1\pgftransformymirror{+\the\pgf@y}}
\def\pgftransformmirror#1{%
  \pgfpointnormalised{#1}%
  \pgf@xa=\pgf@sys@tonumber\pgf@y\pgf@x
  \pgf@xb=\pgf@sys@tonumber\pgf@x\pgf@x
  \pgf@yb=\pgf@sys@tonumber\pgf@y\pgf@y
  \multiply\pgf@xa2\relax
  \pgf@xc=-\pgf@yb\advance\pgf@xc\pgf@xb
  \pgf@yc=-\pgf@xb\advance\pgf@yc\pgf@yb
  \edef\pgf@temp{{\the\pgf@xc}{+\the\pgf@xa}{+\the\pgf@xa}{+\the\pgf@yc}}%
  \expandafter\pgf@transformcm\pgf@temp{\pgfpointorigin}}
\def\pgftransformMirror#1#2{%
  \pgfextract@process\pgf@trans@mirror@A{#1}%
  \pgfextract@process\pgf@trans@mirror@B{#2}%
  \pgfextract@process\pgf@trans@mirror@g{\pgfpointdiff{\pgf@trans@mirror@A}{\pgf@trans@mirror@B}}%
  \pgftransformshift{\pgf@trans@mirror@A}%
  \pgftransformmirror{\pgf@trans@mirror@g}%
  \pgftransformshift{\pgfpointscale{-1}{\pgf@trans@mirror@A}}}
\makeatother

\pgfplotsset{every axis/.append style={
axis x line=middle,    % put the x axis in the middle
axis y line=middle,    % put the y axis in the middle
axis line style={<->}, % arrows on the axis
xlabel={$x$},          % default put x on x-axis
ylabel={$y$},          % default put y on y-axis
}}

\pgfplotsset{soldot/.style={color=black,only marks,mark=*},
 holdot/.style={color=black,fill=white,only marks,mark=*},
 compat=1.12}
 
\usepackage{float}
 
\ifnikolaolydarkmode
\usepackage{pagecolor}
\hypersetup{urlcolor=Cyan,linkcolor=red,citecolor=SkyBlue2}

\pagecolor{black} %black

\color[rgb]{1,1,1} %white

  \ifnikolaolyasy
  \begin{asydef}
    defaultpen(white);
  \end{asydef}
  \fi
\fi

%%% QUICK NOTES %%%
\providecommand{\threedigits}[1]{%
  \ifnum#1<100 0\fi
  \ifnum#1<10 0\fi
  #1%
}
\newcommand{\iiimain}[3]{
\def\inpone{#1}
\def\inptwo{#2}
\def\keywordx{normal}
\def\keywordy{style}
\def\colorred{red}
\def\colorblue{blue}
\def\colorforestgreen{ForestGreen}
\ifx\inpone\keywordx
\item
\else
\ifx\inpone\keywordy
\ifx\inptwo\colorred
\item[\refstepcounter{enumi}\color{\colorred}\textbf{\textsf{\nikolaNameDefinition\ \theenumi.}}]
\else
\ifx\inptwo\colorblue
\item[\refstepcounter{enumi}\color{\colorblue}\textbf{\textsf{\nikolaNameTheorem\ \theenumi.}}]
\else
\ifx\inptwo\colorforestgreen
\item[\refstepcounter{enumi}\color{\colorforestgreen}\textbf{\textsf{\nikolaNameExample\ \theenumi.}}]
\else
\item[\refstepcounter{enumi}\textbf{\textsf{\nikolaNameProblem\ \theenumi.}}]
\fi
\fi
\fi
\else
\item[\refstepcounter{enumi}\fcolorbox{#2}{#3}{\color{#2} \textbf{\protect\threedigits{\theenumi}}}]
\fi
}

\newcommand{\iii}[1][black]{
\iiimain{style}{#1}{#1!20}
}

\newcommand{\rii}{
\iii[red]
}
\newcommand{\gii}{
\iii[ForestGreen]
}
\newcommand{\bii}{
\iii[blue]
}

\newcommand{\dii}{\rii}
\newcommand{\tii}{\bii}
\newcommand{\eii}{\gii}
\newcommand{\pii}{\iii[black]}

\newenvironment{infobox}{%
\begin{enumerate}[wide,labelwidth=!,labelindent=0pt]
}{\end{enumerate}}
